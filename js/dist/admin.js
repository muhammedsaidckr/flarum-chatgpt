(()=>{var t={n:e=>{var a=e&&e.__esModule?()=>e.default:()=>e;return t.d(a,{a}),a},d:(e,a)=>{for(var s in a)t.o(a,s)&&!t.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:a[s]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};(()=>{"use strict";t.r(e);const a=flarum.core.compat["common/app"];t.n(a)().initializers.add("muhammedsaidckr/flarum-chatgpt",(function(){}));const s=flarum.core.compat["admin/app"];var n=t.n(s);function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}const i=flarum.core.compat["admin/components/ExtensionPage"];var o=t.n(i);const d=flarum.core.compat["common/components/Button"];var l=t.n(d),c=["gpt-4.5-preview","gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo","gpt-3.5-turbo-instruct","o1-preview","o1-mini","chatgpt-4o-latest"],p=function(t){var e,a;function s(){for(var e,a=arguments.length,s=new Array(a),n=0;n<a;n++)s[n]=arguments[n];return(e=t.call.apply(t,[this].concat(s))||this).loading=void 0,e.isFetchingModels=void 0,e.models=void 0,e}a=t,(e=s).prototype=Object.create(a.prototype),e.prototype.constructor=e,r(e,a);var i=s.prototype;return i.oninit=function(e){t.prototype.oninit.call(this,e),this.loading=!1,this.isFetchingModels=!1,this.models=this.getModels()},i.getModels=function(){try{var t=n().data.settings["muhammedsaidckr-chatgpt.cached_models"];if(t&&"[]"!==t){var e=JSON.parse(t);if(Array.isArray(e)&&e.length>0)return e.reduce((function(t,e){return t[e.id]=e.id,t}),{})}}catch(t){console.error("Failed to parse cached models:",t)}return c.reduce((function(t,e){return t[e]=e,t}),{})},i.fetchModels=function(){var t=this;this.isFetchingModels=!0,n().request({method:"POST",url:n().forum.attribute("apiUrl")+"/chatgpt/fetch-models"}).then((function(e){t.isFetchingModels=!1,n().data.settings["muhammedsaidckr-chatgpt.cached_models"]=JSON.stringify(e.models),n().data.settings["muhammedsaidckr-chatgpt.models_last_fetched"]=e.last_fetched.toString(),t.models=t.getModels(),n().alerts.show({type:"success"},n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_fetched_success",{count:e.count})),m.redraw()}),(function(e){t.isFetchingModels=!1,n().alerts.show({type:"error"},n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_error")),m.redraw()}))},i.getLastFetchedText=function(){var t=parseInt(n().data.settings["muhammedsaidckr-chatgpt.models_last_fetched"]||"0");if(0===t)return n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_never_fetched");var e=new Date(1e3*t);return n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_last_fetched",{date:e.toLocaleString()})},i.content=function(){var t=this;return m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"Form"},this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.api_key",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.api_key_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.api_key_help",{a:m("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noopener"})}),placeholder:"sk-..."}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.base_uri",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.base_uri_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.base_uri_help"),placeholder:"api.openai.com"}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.model",type:"dropdown",options:this.models,label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.model_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.model_help",{a:m("a",{href:"https://platform.openai.com/docs/models/overview",target:"_blank",rel:"noopener"})})}),m("div",{className:"Form-group"},m("label",null,n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_label")),m("div",null,m(l(),{className:"Button Button--primary",onclick:function(){return t.fetchModels()},loading:this.isFetchingModels,disabled:this.isFetchingModels},n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_button")),m("p",{className:"helpText"},this.getLastFetchedText()))),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.max_tokens",type:"number",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.max_tokens_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.max_tokens_help",{a:m("a",{href:"https://help.openai.com/en/articles/4936856",target:"_blank",rel:"noopener"})}),default:100}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.moderation",type:"boolean",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.moderation_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.moderation_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.user_prompt",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.role",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.role_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.role_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.prompt",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.prompt_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.prompt_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.user_prompt_badge_text",type:"text",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_badge_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_badge_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.queue_active",type:"boolean",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.queue_active_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.queue_active_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.answer_duration",type:"number",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.answer_duration_label")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.enable_on_reply",type:"boolean",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_reply_label")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.enable_on_discussion_started",type:"boolean",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_discussion_started_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_discussion_started_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.continue_to_reply",type:"boolean",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.continue_to_reply_count",type:"number",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_count_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_count_help")}),this.buildSettingComponent({type:"flarum-tags.select-tags",setting:"muhammedsaidckr-chatgpt.enabled-tags",label:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enabled_tags_label"),help:n().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enabled_tags_help"),options:{requireParentTag:!1,limits:{max:{secondary:0}}}}),m("div",{className:"Form-group"},this.submitButton()))))},s}(o());n().initializers.add("muhammedsaidckr-chatgpt",(function(){n().extensionData.for("muhammedsaidckr-chatgpt").registerPermission({label:n().translator.trans("muhammedsaidckr-chatgpt.admin.permissions.use_chatgpt_assistant_label"),icon:"fas fa-comment",permission:"discussion.useChatGPTAssistant",allowGuest:!1},"start").registerPage(p)}))})(),module.exports=e})();
//# sourceMappingURL=admin.js.map