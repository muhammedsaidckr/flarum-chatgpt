(()=>{var t={n:a=>{var e=a&&a.__esModule?()=>a.default:()=>a;return t.d(e,{a:e}),e},d:(a,e)=>{for(var s in e)t.o(e,s)&&!t.o(a,s)&&Object.defineProperty(a,s,{enumerable:!0,get:e[s]})},o:(t,a)=>Object.prototype.hasOwnProperty.call(t,a)};(()=>{"use strict";const a=flarum.core.compat["common/app"];t.n(a)().initializers.add("muhammedsaidckr/flarum-chatgpt",(function(){}));const e=flarum.core.compat["admin/app"];var s=t.n(e);function n(t,a){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,a){return t.__proto__=a,t},n(t,a)}const r=flarum.core.compat["admin/components/ExtensionPage"];var i=t.n(r);const o=flarum.core.compat["common/components/Button"];var d=t.n(o),l=["gpt-4.5-preview","gpt-4o","gpt-4o-mini","gpt-4-turbo","gpt-4","gpt-3.5-turbo","gpt-3.5-turbo-instruct","o1-preview","o1-mini","chatgpt-4o-latest"],c=function(t){function a(){for(var a,e=arguments.length,s=new Array(e),n=0;n<e;n++)s[n]=arguments[n];return(a=t.call.apply(t,[this].concat(s))||this).loading=void 0,a.isFetchingModels=void 0,a.models=void 0,a}var e,r;r=t,(e=a).prototype=Object.create(r.prototype),e.prototype.constructor=e,n(e,r);var i=a.prototype;return i.oninit=function(a){t.prototype.oninit.call(this,a),this.loading=!1,this.isFetchingModels=!1,this.models=this.getModels()},i.getModels=function(){try{var t=s().data.settings["muhammedsaidckr-chatgpt.cached_models"];if(t&&"[]"!==t){var a=JSON.parse(t);if(Array.isArray(a)&&a.length>0)return a.reduce((function(t,a){return t[a.id]=a.id,t}),{})}}catch(t){console.error("Failed to parse cached models:",t)}return l.reduce((function(t,a){return t[a]=a,t}),{})},i.fetchModels=function(){var t=this;this.isFetchingModels=!0,s().request({method:"POST",url:s().forum.attribute("apiUrl")+"/chatgpt/fetch-models"}).then((function(a){t.isFetchingModels=!1,s().data.settings["muhammedsaidckr-chatgpt.cached_models"]=JSON.stringify(a.models),s().data.settings["muhammedsaidckr-chatgpt.models_last_fetched"]=a.last_fetched,t.models=t.getModels(),s().alerts.show({type:"success"},s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_fetched_success",{count:a.count})),m.redraw()}),(function(a){t.isFetchingModels=!1,s().alerts.show({type:"error"},s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_error")),m.redraw()}))},i.getLastFetchedText=function(){var t=parseInt(s().data.settings["muhammedsaidckr-chatgpt.models_last_fetched"]||"0");if(0===t)return s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_never_fetched");var a=new Date(1e3*t);return s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.models_last_fetched",{date:a.toLocaleString()})},i.content=function(){var t=this;return m("div",{className:"ExtensionPage-settings"},m("div",{className:"container"},m("div",{className:"Form"},this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.api_key",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.api_key_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.api_key_help",{a:m("a",{href:"https://platform.openai.com/account/api-keys",target:"_blank",rel:"noopener"})}),placeholder:"sk-..."}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.base_uri",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.base_uri_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.base_uri_help"),placeholder:"api.openai.com"}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.model",type:"dropdown",options:this.models,label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.model_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.model_help",{a:m("a",{href:"https://platform.openai.com/docs/models/overview",target:"_blank",rel:"noopener"})})}),m("div",{className:"Form-group"},m("label",null,s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_label")),m("div",null,m(d(),{className:"Button Button--primary",onclick:function(){return t.fetchModels()},loading:this.isFetchingModels,disabled:this.isFetchingModels},s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.fetch_models_button")),m("p",{className:"helpText"},this.getLastFetchedText()))),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.max_tokens",type:"number",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.max_tokens_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.max_tokens_help",{a:m("a",{href:"https://help.openai.com/en/articles/4936856",target:"_blank",rel:"noopener"})}),default:100}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.moderation",type:"boolean",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.moderation_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.moderation_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.user_prompt",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.role",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.role_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.role_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.prompt",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.prompt_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.prompt_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.user_prompt_badge_text",type:"text",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_badge_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.user_prompt_badge_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.queue_active",type:"boolean",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.queue_active_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.queue_active_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.answer_duration",type:"number",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.answer_duration_label")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.enable_on_reply",type:"boolean",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_reply_label")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.enable_on_discussion_started",type:"boolean",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_discussion_started_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enable_on_discussion_started_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.continue_to_reply",type:"boolean",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_help")}),this.buildSettingComponent({setting:"muhammedsaidckr-chatgpt.continue_to_reply_count",type:"number",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_count_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.continue_to_reply_count_help")}),this.buildSettingComponent({type:"flarum-tags.select-tags",setting:"muhammedsaidckr-chatgpt.enabled-tags",label:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enabled_tags_label"),help:s().translator.trans("muhammedsaidckr-chatgpt.admin.settings.enabled_tags_help"),options:{requireParentTag:!1,limits:{max:{secondary:0}}}}),m("div",{className:"Form-group"},this.submitButton()))))},a}(i());s().initializers.add("muhammedsaidckr-chatgpt",(function(){s().extensionData.for("muhammedsaidckr-chatgpt").registerPermission({label:s().translator.trans("muhammedsaidckr-chatgpt.admin.permissions.use_chatgpt_assistant_label"),icon:"fas fa-comment",permission:"discussion.useChatGPTAssistant",allowGuest:!1},"start").registerPage(c)}))})(),module.exports={}})();
//# sourceMappingURL=admin.js.map